import pandas as pd
import datetime
from options_framework.option import Option
from options_framework.option_types import OptionType
from tests.test_helpers import expiration_to_date, create_option_objects

column_names = ['quote_datetime','option_id','root','strike','expiration','option_type','active_underlying_price',
                'bid','ask','mid','delta','gamma','theta','vega','rho','open_interest','trade_volume',
                'implied_volatility']
col_mapping = {
    'quote_datetime': 'quote_datetime',
    'option_id': 'option_id',
    'root': 'symbol',
    'strike': 'strike',
    'expiration': 'expiration',
    'option_type': 'option_type',
    'active_underlying_price':'spot_price',
    'bid':'bid',
    'ask':'ask',
    'mid':'price',
    'delta':'delta',
    'gamma':'gamma',
    'theta':'theta',
    'vega':'vega',
    'rho':'rho',
    'open_interest': 'open_interest',
    'trade_volume':'volume',
    'implied_volatility':'implied_volatility',
}
fields_ = [col_mapping[f] for f in column_names if f in col_mapping.keys()]

data = [
['2016-03-08 09:31','SPXW20160309C00001960','SPXW',1960,'2016-03-09','C',1991.18,27.2,29.7,28.45,0.8817,0.0085,-1.3502,0.234,6.0964,72,0,0.196],
['2016-03-08 09:31','SPXW20160309P00001960','SPXW',1960,'2016-03-09','P',1991.18,1.25,1.4,1.32,-0.117,0.0085,-1.3249,0.2322,-0.8268,820,42,0.1949],
['2016-03-08 09:31','SPXW20160309C00001990','SPXW',1990,'2016-03-09','C',1991.18,6.2,6.9,6.55,0.4439,0.0199,-3.0396,0.4668,3.0964,2417,45,0.1678],
['2016-03-08 09:31','SPXW20160309P00001990','SPXW',1990,'2016-03-09','P',1991.18,8.9,10,9.45,-0.5561,0.0199,-3.0249,0.4668,-3.942,911,0,0.1678],
['2016-03-08 09:31','SPXW20160309C00002000','SPXW',2000,'2016-03-09','C',1991.18,2.5,2.9,2.7,0.2459,0.017,-2.2708,0.3723,1.719,4817,91,0.1572],
['2016-03-08 09:31','SPXW20160309P00002000','SPXW',2000,'2016-03-09','P',1991.18,14.8,16.3,15.55,-0.7559,0.017,-2.2273,0.3707,-5.3678,1266,0,0.1559],
['2016-03-08 09:31','SPXW20160309C00002010','SPXW',2010,'2016-03-09','C',1991.18,0.75,1,0.88,0.1029,0.01,-0.875,0.2117,0.7199,2490,119,0.1517],
['2016-03-08 09:31','SPXW20160309P00002010','SPXW',2010,'2016-03-09','P',1991.18,22.4,25.2,23.8,-0.8953,0.01,-0.9002,0.2144,-6.3768,297,0,0.1529],
['2016-03-08 09:31','SPXW20160311C00001960','SPXW',1960,'2016-03-11','C',1991.18,31.1,33.3,32.2,0.7507,0.008,-1.9218,0.5985,13.153,529,40,0.2102],
['2016-03-08 09:31','SPXW20160311P00001960','SPXW',1960,'2016-03-11','P',1991.18,5.6,5.9,5.75,-0.2459,0.0081,-1.8631,0.5941,-4.4564,2746,10,0.2068],
['2016-03-08 09:31','SPXW20160311C00001990','SPXW',1990,'2016-03-11','C',1991.18,12,12.5,12.25,0.4611,0.0113,-2.1285,0.7488,8.1471,10469,3,0.1865],
['2016-03-08 09:31','SPXW20160311P00001990','SPXW',1990,'2016-03-11','P',1991.18,15.5,16.4,15.95,-0.5391,0.0113,-2.1061,0.7488,-9.7975,5032,5,0.1858],
['2016-03-08 09:31','SPXW20160311C00002000','SPXW',2000,'2016-03-11','C',1991.18,7.6,8,7.8,0.3463,0.0109,-1.9069,0.6958,6.1314,13858,5,0.1799],
['2016-03-08 09:31','SPXW20160311P00002000','SPXW',2000,'2016-03-11','P',1991.18,20.8,22.2,21.5,-0.6543,0.0109,-1.8833,0.6954,-11.9113,3891,7,0.1792],
['2016-03-08 09:31','SPXW20160311C00002010','SPXW',2010,'2016-03-11','C',1991.18,4.3,4.6,4.45,0.2359,0.0095,-1.5213,0.5808,4.1844,3520,4,0.172],
['2016-03-08 09:31','SPXW20160311P00002010','SPXW',2010,'2016-03-11','P',1991.18,27.1,29.1,28.1,-0.7664,0.0095,-1.4833,0.5777,-13.9777,885,0,0.1703],
['2016-03-08 09:31','SPXW20160316C00001960','SPXW',1960,'2016-03-16','C',1991.18,37.3,39,38.15,0.681,0.0062,-1.2486,1.069,29.8515,43,0,0.1922],
['2016-03-08 09:31','SPXW20160316P00001960','SPXW',1960,'2016-03-16','P',1991.18,12,12.5,12.25,-0.3202,0.0062,-1.2447,1.0706,-14.7208,110,41,0.1935],
['2016-03-08 09:31','SPXW20160316C00001990','SPXW',1990,'2016-03-16','C',1991.18,19,19.6,19.3,0.4757,0.0075,-1.2827,1.1919,21.0217,66,0,0.1775],
['2016-03-08 09:31','SPXW20160316P00001990','SPXW',1990,'2016-03-16','P',1991.18,22.9,23.8,23.35,-0.5241,0.0075,-1.2741,1.1919,-24.1732,32,2,0.1784],
['2016-03-08 09:31','SPXW20160316C00002000','SPXW',2000,'2016-03-16','C',1991.18,14.1,14.7,14.4,0.3987,0.0075,-1.2053,1.1553,17.6571,500,0,0.1722],
['2016-03-08 09:31','SPXW20160316P00002000','SPXW',2000,'2016-03-16','P',1991.18,28,29,28.5,-0.6005,0.0074,-1.2002,1.156,-27.7364,147,0,0.1735],
['2016-03-08 09:31','SPXW20160316C00002010','SPXW',2010,'2016-03-16','C',1991.18,10.1,10.5,10.3,0.3213,0.0072,-1.0832,1.0721,14.2579,489,0,0.1668],
['2016-03-08 09:31','SPXW20160316P00002010','SPXW',2010,'2016-03-16','P',1991.18,33.2,35.1,34.15,-0.6797,0.0072,-1.061,1.0708,-31.4379,71,0,0.1659],
['2016-03-08 09:45','SPXW20160309C00001960','SPXW',1960,'2016-03-09','C',1984.7,24.1,27,25.55,0.8412,0.0102,-2.0002,0.2845,5.7673,72,0,0.2029],
['2016-03-08 09:45','SPXW20160309P00001960','SPXW',1960,'2016-03-09','P',1984.7,1.5,1.75,1.62,-0.1421,0.0101,-1.6248,0.2643,-0.9955,820,17,0.1893],
['2016-03-08 09:45','SPXW20160309C00001990','SPXW',1990,'2016-03-09','C',1984.7,4.9,5.2,5.05,0.3735,0.0193,-2.9116,0.4451,2.583,2417,4,0.1673],
['2016-03-08 09:45','SPXW20160309P00001990','SPXW',1990,'2016-03-09','P',1984.7,10.4,12.9,11.65,-0.624,0.0189,-2.9616,0.446,-4.3855,911,0,0.1707],
['2016-03-08 09:45','SPXW20160309C00002000','SPXW',2000,'2016-03-09','C',1984.7,1.8,2,1.9,0.1884,0.0146,-1.8997,0.3173,1.3053,4817,10,0.1569],
['2016-03-08 09:45','SPXW20160309P00002000','SPXW',2000,'2016-03-09','P',1984.7,16.9,19.8,18.35,-0.8116,0.0146,-1.8998,0.3173,-5.7151,1266,0,0.1569],
['2016-03-08 09:45','SPXW20160309C00002010','SPXW',2010,'2016-03-09','C',1984.7,0.5,0.7,0.6,0.0743,0.0078,-0.6003,0.1652,0.5153,2490,1,0.1543],
['2016-03-08 09:45','SPXW20160309P00002010','SPXW',2010,'2016-03-09','P',1984.7,25.2,28.4,26.8,-0.9481,0.0066,-0.3501,0.1248,-6.6957,297,0,0.1371],
['2016-03-08 09:45','SPXW20160311C00001960','SPXW',1960,'2016-03-11','C',1984.7,29,30.3,29.65,0.7291,0.0085,-1.968,0.6227,12.7316,529,0,0.2063],
['2016-03-08 09:45','SPXW20160311P00001960','SPXW',1960,'2016-03-11','P',1984.7,6.4,6.7,6.55,-0.2716,0.0085,-1.9637,0.6236,-4.9016,2746,3,0.2071],
['2016-03-08 09:45','SPXW20160311C00001990','SPXW',1990,'2016-03-11','C',1984.7,10.7,11.1,10.9,0.4264,0.0111,-2.1085,0.7373,7.5041,10469,0,0.1871],
['2016-03-08 09:45','SPXW20160311P00001990','SPXW',1990,'2016-03-11','P',1984.7,17.4,18.2,17.8,-0.5733,0.0111,-2.1018,0.7374,-10.3803,5032,0,0.1878],
['2016-03-08 09:45','SPXW20160311C00002000','SPXW',2000,'2016-03-11','C',1984.7,6.6,6.9,6.75,0.3128,0.0105,-1.8284,0.6659,5.5157,13858,20,0.1797],
['2016-03-08 09:45','SPXW20160311P00002000','SPXW',2000,'2016-03-11','P',1984.7,23.1,25.1,24.1,-0.68,0.0102,-1.908,0.6724,-12.3398,3891,1,0.1872],
['2016-03-08 09:45','SPXW20160311C00002010','SPXW',2010,'2016-03-11','C',1984.7,3.7,4,3.85,0.2097,0.0088,-1.4375,0.5414,3.7035,3520,0,0.1739],
['2016-03-08 09:45','SPXW20160311P00002010','SPXW',2010,'2016-03-11','P',1984.7,29.9,32.1,31,-0.7829,0.0087,-1.4987,0.5525,-14.2361,885,0,0.1794],
['2016-03-08 09:45','SPXW20160316C00001960','SPXW',1960,'2016-03-16','C',1984.7,34.9,36.5,35.7,0.6601,0.0064,-1.2713,1.094,28.8817,43,0,0.191],
['2016-03-08 09:45','SPXW20160316P00001960','SPXW',1960,'2016-03-16','P',1984.7,13.1,13.6,13.35,-0.3415,0.0064,-1.2741,1.096,-15.6647,110,0,0.1933],
['2016-03-08 09:45','SPXW20160316C00001990','SPXW',1990,'2016-03-16','C',1984.7,17.3,18,17.65,0.4498,0.0075,-1.2706,1.1818,19.8294,66,6,0.1772],
['2016-03-08 09:45','SPXW20160316P00001990','SPXW',1990,'2016-03-16','P',1984.7,24.2,25.7,24.95,-0.5505,0.0075,-1.2498,1.1817,-25.3285,32,0,0.1763],
['2016-03-08 09:45','SPXW20160316C00002000','SPXW',2000,'2016-03-16','C',1984.7,12.7,13.3,13,0.3726,0.0074,-1.1765,1.13,16.4632,500,0,0.1716],
['2016-03-08 09:45','SPXW20160316P00002000','SPXW',2000,'2016-03-16','P',1984.7,29.7,31.2,30.45,-0.6271,0.0074,-1.1651,1.1303,-28.8963,147,0,0.1721],
['2016-03-08 09:45','SPXW20160316C00002010','SPXW',2010,'2016-03-16','C',1984.7,8.9,9.4,9.15,0.296,0.007,-1.0391,1.0318,13.1041,489,0,0.1661],
['2016-03-08 09:45','SPXW20160316P00002010','SPXW',2010,'2016-03-16','P',1984.7,35.6,37.5,36.55,-0.704,0.007,-1.0244,1.0319,-32.496,71,5,0.1661],
['2016-03-08 09:55','SPXW20160309C00001960','SPXW',1960,'2016-03-09','C',1989.14,28,31.1,29.55,0.8982,0.0079,-1.1003,0.2089,6.1323,72,0,0.1927],
['2016-03-08 09:55','SPXW20160309P00001960','SPXW',1960,'2016-03-09','P',1989.14,1.05,1.25,1.15,-0.1045,0.0079,-1.15,0.2129,-0.7297,820,0,0.1951],
['2016-03-08 09:55','SPXW20160309C00001990','SPXW',1990,'2016-03-09','C',1989.14,6.6,7.3,6.95,0.4815,0.0214,-2.9128,0.4684,3.3192,2417,0,0.1581],
['2016-03-08 09:55','SPXW20160309P00001990','SPXW',1990,'2016-03-09','P',1989.14,7.9,9.1,8.5,-0.5301,0.0206,-3.0037,0.4674,-3.7095,911,1,0.1642],
['2016-03-08 09:55','SPXW20160309C00002000','SPXW',2000,'2016-03-09','C',1989.14,2.7,2.95,2.82,0.2616,0.0182,-2.2913,0.3823,1.8064,4817,0,0.1525],
['2016-03-08 09:55','SPXW20160309P00002000','SPXW',2000,'2016-03-09','P',1989.14,13.6,15.3,14.45,-0.7357,0.018,-2.318,0.3843,-5.1577,1266,0,0.1544],
['2016-03-08 09:55','SPXW20160309C00002010','SPXW',2010,'2016-03-09','C',1989.14,0.75,0.95,0.85,0.1048,0.0107,-0.85,0.2134,0.7246,2490,0,0.1449],
['2016-03-08 09:55','SPXW20160309P00002010','SPXW',2010,'2016-03-09','P',1989.14,21.2,23.6,22.4,-0.8952,0.0107,-0.8502,0.2134,-6.2926,297,0,0.1449],
['2016-03-08 09:55','SPXW20160311C00001960','SPXW',1960,'2016-03-11','C',1989.14,32.5,33.8,33.15,0.7647,0.0078,-1.8513,0.5789,13.3382,529,0,0.2082],
['2016-03-08 09:55','SPXW20160311P00001960','SPXW',1960,'2016-03-11','P',1989.14,5.1,5.4,5.25,-0.2316,0.0079,-1.7904,0.5739,-4.177,2746,8,0.2047],
['2016-03-08 09:55','SPXW20160311C00001990','SPXW',1990,'2016-03-11','C',1989.14,12.6,13,12.8,0.4814,0.0116,-2.1002,0.7504,8.4711,10469,0,0.1827],
['2016-03-08 09:55','SPXW20160311P00001990','SPXW',1990,'2016-03-11','P',1989.14,14.7,15.5,15.1,-0.5228,0.0114,-2.1131,0.7498,-9.457,5032,6,0.1852],
['2016-03-08 09:55','SPXW20160311C00002000','SPXW',2000,'2016-03-11','C',1989.14,8,8.4,8.2,0.3609,0.0111,-1.9293,0.7049,6.3622,13858,5,0.1787],
['2016-03-08 09:55','SPXW20160311P00002000','SPXW',2000,'2016-03-11','P',1989.14,19.8,21.3,20.55,-0.6385,0.0111,-1.9231,0.7053,-11.5693,3891,0,0.1794],
['2016-03-08 09:55','SPXW20160311C00002010','SPXW',2010,'2016-03-11','C',1989.14,4.7,4.9,4.8,0.2499,0.0098,-1.5787,0.5981,4.4124,3520,8,0.1725],
['2016-03-08 09:55','SPXW20160311P00002010','SPXW',2010,'2016-03-11','P',1989.14,26.3,27.8,27.05,-0.7512,0.0098,-1.5527,0.5967,-13.6367,885,0,0.1716],
['2016-03-08 09:55','SPXW20160316C00001960','SPXW',1960,'2016-03-16','C',1989.14,37.9,39.6,38.75,0.6884,0.0062,-1.2325,1.0578,30.1281,43,0,0.1913],
['2016-03-08 09:55','SPXW20160316P00001960','SPXW',1960,'2016-03-16','P',1989.14,11.5,11.8,11.65,-0.3116,0.0062,-1.2179,1.0578,-14.3004,110,1,0.1913],
['2016-03-08 09:55','SPXW20160316C00001990','SPXW',1990,'2016-03-16','C',1989.14,19.5,20,19.75,0.4835,0.0075,-1.2841,1.1925,21.332,66,2,0.1772],
['2016-03-08 09:55','SPXW20160316P00001990','SPXW',1990,'2016-03-16','P',1989.14,22.2,22.9,22.55,-0.5166,0.0076,-1.2634,1.1925,-23.7807,32,0,0.1764],
['2016-03-08 09:55','SPXW20160316C00002000','SPXW',2000,'2016-03-16','C',1989.14,14.6,15,14.8,0.4064,0.0075,-1.213,1.1605,17.9719,500,1,0.1721],
['2016-03-08 09:55','SPXW20160316P00002000','SPXW',2000,'2016-03-16','P',1989.14,27.1,28,27.55,-0.5943,0.0076,-1.1886,1.16,-27.3951,147,0,0.1709],
['2016-03-08 09:55','SPXW20160316C00002010','SPXW',2010,'2016-03-16','C',1989.14,10.4,10.8,10.6,0.3284,0.0073,-1.0934,1.0814,14.5535,489,0,0.1666],
['2016-03-08 09:55','SPXW20160316P00002010','SPXW',2010,'2016-03-16','P',1989.14,32.3,34.1,33.2,-0.6744,0.0073,-1.0567,1.0775,-31.131,71,0,0.1638],
['2016-03-08 16:00','SPXW20160309C00001960','SPXW',1960,'2016-03-09','C',1979.61,18.2,22.7,20.45,0.8496,0.0126,-1.4502,0.2444,4.6454,72,0,0.1771],
['2016-03-08 16:00','SPXW20160309P00001960','SPXW',1960,'2016-03-09','P',1979.61,1.4,1.8,1.6,-0.1584,0.0126,-1.6,0.2529,-0.8811,820,0,0.1831],
['2016-03-08 16:00','SPXW20160309C00001990','SPXW',1990,'2016-03-09','C',1979.61,2.5,2.9,2.7,0.2619,0.019,-2.7,0.3408,1.4422,2417,86,0.1633],
['2016-03-08 16:00','SPXW20160309P00001990','SPXW',1990,'2016-03-09','P',1979.61,11.5,15.9,13.7,-0.7381,0.019,-2.7001,0.3408,-4.1234,911,3,0.1633],
['2016-03-08 16:00','SPXW20160309C00002000','SPXW',2000,'2016-03-09','C',1979.61,0.8,1,0.9,0.1101,0.0111,-0.9,0.197,0.607,4817,0,0.1623],
['2016-03-08 16:00','SPXW20160309P00002000','SPXW',2000,'2016-03-09','P',1979.61,19.3,24.1,21.7,-0.9054,0.0106,-0.7002,0.1763,-5.0719,1266,0,0.1516],
['2016-03-08 16:00','SPXW20160309C00002010','SPXW',2010,'2016-03-09','C',1979.61,0.2,0.25,0.22,0.034,0.0045,-0.225,0.079,0.1878,2490,120,0.1607],
['2016-03-08 16:00','SPXW20160309P00002010','SPXW',2010,'2016-03-09','P',1979.61,28.5,33.5,31,-0.9999,0,0,0.0004,-5.621,297,0,0.0791],
['2016-03-08 16:00','SPXW20160311C00001960','SPXW',1960,'2016-03-11','C',1979.61,23.8,27.5,25.65,0.6914,0.0094,-2.1826,0.6336,11.1072,529,0,0.2072],
['2016-03-08 16:00','SPXW20160311P00001960','SPXW',1960,'2016-03-11','P',1979.61,7.3,7.8,7.55,-0.3099,0.0094,-2.1885,0.6348,-5.1356,2746,2,0.2087],
['2016-03-08 16:00','SPXW20160311C00001990','SPXW',1990,'2016-03-11','C',1979.61,8.6,8.9,8.75,0.3703,0.0109,-2.1704,0.6797,5.9908,10469,4,0.1924],
['2016-03-08 16:00','SPXW20160311P00001990','SPXW',1990,'2016-03-11','P',1979.61,18.4,22.2,20.3,-0.6322,0.0111,-2.1095,0.6781,-10.5184,5032,0,0.1888],
['2016-03-08 16:00','SPXW20160311C00002000','SPXW',2000,'2016-03-11','C',1979.61,5,5.4,5.2,0.2603,0.0097,-1.7935,0.5841,4.2189,13858,44,0.1851],
['2016-03-08 16:00','SPXW20160311P00002000','SPXW',2000,'2016-03-11','P',1979.61,25.1,29.1,27.1,-0.7377,0.0097,-1.8029,0.5864,-12.3012,3891,10,0.1869],
['2016-03-08 16:00','SPXW20160311C00002010','SPXW',2010,'2016-03-11','C',1979.61,2.75,2.9,2.82,0.1661,0.0077,-1.3334,0.4486,2.6957,3520,0,0.1793],
['2016-03-08 16:00','SPXW20160311P00002010','SPXW',2010,'2016-03-11','P',1979.61,32.1,36.7,34.4,-0.841,0.0077,-1.2445,0.4361,-14.0534,885,0,0.1742],
['2016-03-08 16:00','SPXW20160316C00001960','SPXW',1960,'2016-03-16','C',1979.61,30,33.9,31.95,0.6323,0.0068,-1.3049,1.1046,26.7784,43,0,0.1882],
['2016-03-08 16:00','SPXW20160316P00001960','SPXW',1960,'2016-03-16','P',1979.61,14,14.6,14.3,-0.3685,0.0068,-1.3006,1.1055,-16.3291,110,0,0.1895],
['2016-03-08 16:00','SPXW20160316C00001990','SPXW',1990,'2016-03-16','C',1979.61,14.2,15.4,14.8,0.4103,0.0077,-1.2367,1.1399,17.5079,66,0,0.1732],
['2016-03-08 16:00','SPXW20160316P00001990','SPXW',1990,'2016-03-16','P',1979.61,25.3,29.1,27.2,-0.5887,0.0076,-1.2352,1.1406,-26.181,32,0,0.175],
['2016-03-08 16:00','SPXW20160316C00002000','SPXW',2000,'2016-03-16','C',1979.61,10.4,10.9,10.65,0.3318,0.0074,-1.1214,1.0641,14.1877,500,1,0.1683],
['2016-03-08 16:00','SPXW20160316P00002000','SPXW',2000,'2016-03-16','P',1979.61,30.7,34.9,32.8,-0.6686,0.0074,-1.103,1.0635,-29.778,147,0,0.1679],
['2016-03-08 16:00','SPXW20160316C00002010','SPXW',2010,'2016-03-16','C',1979.61,7,7.7,7.35,0.2571,0.0067,-0.9701,0.9454,11.0122,489,1,0.164],
['2016-03-08 16:00','SPXW20160316P00002010','SPXW',2010,'2016-03-16','P',1979.61,37.2,41.6,39.4,-0.745,0.0067,-0.9418,0.9414,-33.243,71,0,0.1624],
['2016-03-08 16:01','SPXW20160309C00001960','SPXW',1960,'2016-03-09','C',1979.29,21.5,24.8,23.15,0.8631,0.0109,-1.4002,0.2297,4.7155,72,0,0.1917],
['2016-03-08 16:01','SPXW20160309P00001960','SPXW',1960,'2016-03-09','P',1979.29,1.05,1.3,1.18,-0.1241,0.0108,-1.1741,0.2145,-0.6904,820,0,0.1815],
['2016-03-08 16:01','SPXW20160309C00001990','SPXW',1990,'2016-03-09','C',1979.29,3.4,3.7,3.55,0.3184,0.0207,-3.0256,0.3739,1.7534,2417,25,0.1649],
['2016-03-08 16:01','SPXW20160309P00001990','SPXW',1990,'2016-03-09','P',1979.29,10.9,13,11.95,-0.6776,0.0203,-3.1008,0.3759,-3.7862,911,0,0.1689],
['2016-03-08 16:01','SPXW20160309C00002000','SPXW',2000,'2016-03-09','C',1979.29,1.05,1.25,1.15,0.1373,0.0133,-1.15,0.2302,0.7575,4817,1,0.1581],
['2016-03-08 16:01','SPXW20160309P00002000','SPXW',2000,'2016-03-09','P',1979.29,17.7,20.7,19.2,-0.8767,0.013,-0.9502,0.2136,-4.9096,1266,0,0.1491],
['2016-03-08 16:01','SPXW20160309C00002010','SPXW',2010,'2016-03-09','C',1979.29,0.25,0.3,0.28,0.0419,0.0055,-0.275,0.0938,0.2314,2490,2,0.1545],
['2016-03-08 16:01','SPXW20160309P00002010','SPXW',2010,'2016-03-09','P',1979.29,26.7,30,28.35,-0.9799,0.0036,-0.1002,0.0508,-5.5069,297,0,0.1302],
['2016-03-08 16:01','SPXW20160311C00001960','SPXW',1960,'2016-03-11','C',1979.29,26.7,28.4,27.55,0.7204,0.0091,-2.0658,0.6062,11.5809,529,0,0.2048],
['2016-03-08 16:01','SPXW20160311P00001960','SPXW',1960,'2016-03-11','P',1979.29,6.5,6.8,6.65,-0.2826,0.009,-2.0951,0.6093,-4.6874,2746,0,0.2081],
['2016-03-08 16:01','SPXW20160311C00001990','SPXW',1990,'2016-03-11','C',1979.29,9.6,10,9.8,0.4018,0.0112,-2.2153,0.697,6.5054,10469,19,0.1915],
['2016-03-08 16:01','SPXW20160311P00001990','SPXW',1990,'2016-03-11','P',1979.29,18.1,19.5,18.8,-0.5974,0.0111,-2.2182,0.6974,-9.9484,5032,0,0.1929],
['2016-03-08 16:01','SPXW20160311C00002000','SPXW',2000,'2016-03-11','C',1979.29,5.8,6.2,6,0.2894,0.0102,-1.894,0.6163,4.6945,13858,2,0.1852],
['2016-03-08 16:01','SPXW20160311P00002000','SPXW',2000,'2016-03-11','P',1979.29,23.9,25.8,24.85,-0.7114,0.0103,-1.8684,0.6154,-11.8675,3891,0,0.1844],
['2016-03-08 16:01','SPXW20160311C00002010','SPXW',2010,'2016-03-11','C',1979.29,3.2,3.4,3.3,0.1883,0.0084,-1.4398,0.4864,3.0601,3520,0,0.1785],
['2016-03-08 16:01','SPXW20160311P00002010','SPXW',2010,'2016-03-11','P',1979.29,30.8,33.3,32.05,-0.8159,0.0084,-1.3802,0.4796,-13.6394,885,0,0.1754],
['2016-03-08 16:01','SPXW20160316C00001960','SPXW',1960,'2016-03-16','C',1979.29,32.8,34.7,33.75,0.6518,0.0067,-1.2809,1.0854,27.6234,43,0,0.1879],
['2016-03-08 16:01','SPXW20160316P00001960','SPXW',1960,'2016-03-16','P',1979.29,12.9,13.4,13.15,-0.3485,0.0067,-1.2698,1.0857,-15.4561,110,0,0.1884],
['2016-03-08 16:01','SPXW20160316C00001990','SPXW',1990,'2016-03-16','C',1979.29,15.8,16.3,16.05,0.4325,0.0077,-1.2559,1.1544,18.4674,66,0,0.1736],
['2016-03-08 16:01','SPXW20160316P00001990','SPXW',1990,'2016-03-16','P',1979.29,25,25.9,25.45,-0.5673,0.0077,-1.2444,1.1545,-25.2489,32,0,0.1741],
['2016-03-08 16:01','SPXW20160316C00002000','SPXW',2000,'2016-03-16','C',1979.29,11.5,11.8,11.65,0.3533,0.0075,-1.1519,1.0911,15.1173,500,0,0.1686],
['2016-03-08 16:01','SPXW20160316P00002000','SPXW',2000,'2016-03-16','P',1979.29,29.9,31.8,30.85,-0.648,0.0076,-1.1264,1.0897,-28.8757,147,0,0.1672],
['2016-03-08 16:01','SPXW20160316C00002010','SPXW',2010,'2016-03-16','C',1979.29,7.8,8.2,8,0.2752,0.007,-0.9988,0.9799,11.7983,489,0,0.1628],
['2016-03-08 16:01','SPXW20160316P00002010','SPXW',2010,'2016-03-16','P',1979.29,36.2,38.3,37.25,-0.7261,0.007,-0.9755,0.9776,-32.4185,71,0,0.1618],
['2016-03-08 16:15','SPXW20160309C00001960','SPXW',1960,'2016-03-09','C',1979.26,22.2,24.9,23.55,0.886,0.0102,-1.0501,0.2013,4.797,72,0,0.1807],
['2016-03-08 16:15','SPXW20160309P00001960','SPXW',1960,'2016-03-09','P',1979.26,0.85,1.3,1.08,-0.1156,0.0103,-1.075,0.2032,-0.6374,820,105,0.1819],
['2016-03-08 16:15','SPXW20160309C00001990','SPXW',1990,'2016-03-09','C',1979.26,3.4,4.2,3.8,0.3341,0.021,-3.1188,0.3796,1.8231,2417,0,0.1658],
['2016-03-08 16:15','SPXW20160309P00001990','SPXW',1990,'2016-03-09','P',1979.26,9.6,12.9,11.25,-0.6672,0.0212,-3.0748,0.379,-3.6925,911,0,0.1645],
['2016-03-08 16:15','SPXW20160309C00002000','SPXW',2000,'2016-03-09','C',1979.26,1.2,1.25,1.23,0.1455,0.0139,-1.225,0.2383,0.7951,4817,1,0.1576],
['2016-03-08 16:15','SPXW20160309P00002000','SPXW',2000,'2016-03-09','P',1979.26,16.8,20.5,18.65,-0.8595,0.0139,-1.1501,0.2328,-4.7683,1266,0,0.1544],
['2016-03-08 16:15','SPXW20160309C00002010','SPXW',2010,'2016-03-09','C',1979.26,0.2,0.35,0.28,0.0427,0.0057,-0.275,0.0948,0.2336,2490,0,0.1519],
['2016-03-08 16:15','SPXW20160309P00002010','SPXW',2010,'2016-03-09','P',1979.26,25.7,29.5,27.6,-0.9795,0.0037,-0.1002,0.0515,-5.4522,297,0,0.1279],
['2016-03-08 16:15','SPXW20160311C00001960','SPXW',1960,'2016-03-11','C',1979.26,27.2,29.3,28.25,0.7227,0.0089,-2.1031,0.6029,11.5798,529,0,0.209],
['2016-03-08 16:15','SPXW20160311P00001960','SPXW',1960,'2016-03-11','P',1979.26,6.1,6.9,6.5,-0.2773,0.0089,-2.0885,0.6029,-4.5852,2746,0,0.209],
['2016-03-08 16:15','SPXW20160311C00001990','SPXW',1990,'2016-03-11','C',1979.26,9.8,10.5,10.15,0.4097,0.0112,-2.2484,0.6995,6.6132,10469,0,0.193],
['2016-03-08 16:15','SPXW20160311P00001990','SPXW',1990,'2016-03-11','P',1979.26,16.9,19.4,18.15,-0.5921,0.0114,-2.1898,0.6988,-9.8268,5032,0,0.1894],
['2016-03-08 16:15','SPXW20160311C00002000','SPXW',2000,'2016-03-11','C',1979.26,5.9,6.6,6.25,0.2971,0.0103,-1.934,0.623,4.8043,13858,10,0.1865],
['2016-03-08 16:15','SPXW20160311P00002000','SPXW',2000,'2016-03-11','P',1979.26,22.9,25.7,24.3,-0.7062,0.0104,-1.8761,0.6198,-11.7435,3891,0,0.1833],
['2016-03-08 16:15','SPXW20160311C00002010','SPXW',2010,'2016-03-11','C',1979.26,3.3,3.6,3.45,0.1946,0.0085,-1.4783,0.4955,3.1515,3520,0,0.1793],
['2016-03-08 16:15','SPXW20160311P00002010','SPXW',2010,'2016-03-11','P',1979.26,29.9,33.1,31.5,-0.811,0.0086,-1.405,0.4869,-13.5145,885,0,0.1752],
['2016-03-08 16:15','SPXW20160316C00001960','SPXW',1960,'2016-03-16','C',1979.26,33.4,35.2,34.3,0.6564,0.0066,-1.2804,1.0798,27.7889,43,0,0.1886],
['2016-03-08 16:15','SPXW20160316P00001960','SPXW',1960,'2016-03-16','P',1979.26,12.2,13.5,12.85,-0.3432,0.0067,-1.2622,1.0794,-15.2071,110,0,0.1881],
['2016-03-08 16:15','SPXW20160316C00001990','SPXW',1990,'2016-03-16','C',1979.26,16,16.9,16.45,0.4385,0.0077,-1.2657,1.157,18.7065,66,0,0.1744],
['2016-03-08 16:15','SPXW20160316P00001990','SPXW',1990,'2016-03-16','P',1979.26,23.9,25.9,24.9,-0.562,0.0078,-1.2414,1.1568,-24.9839,32,0,0.1731],
['2016-03-08 16:15','SPXW20160316C00002000','SPXW',2000,'2016-03-16','C',1979.26,11.5,12.4,11.95,0.3592,0.0075,-1.1626,1.0972,15.3549,500,0,0.169],
['2016-03-08 16:15','SPXW20160316P00002000','SPXW',2000,'2016-03-16','P',1979.26,29.3,31.6,30.45,-0.6416,0.0076,-1.1407,1.0964,-28.5666,147,0,0.1681],
['2016-03-08 16:15','SPXW20160316C00002010','SPXW',2010,'2016-03-16','C',1979.26,7.9,8.4,8.15,0.2797,0.0071,-1.0047,0.9875,11.9817,489,0,0.1624],
['2016-03-08 16:15','SPXW20160316P00002010','SPXW',2010,'2016-03-16','P',1979.26,35.5,38,36.75,-0.7203,0.0071,-0.99,0.9875,-32.1269,71,0,0.1624],
['2016-03-09 09:31','SPXW20160309C00001960','SPXW',1960,'2016-03-09','C',1987.02,28,30.7,29.35,0.9623,0.005,-0.2501,0.0461,1.5025,67,0,0.2943],
['2016-03-09 09:31','SPXW20160309P00001960','SPXW',1960,'2016-03-09','P',1987.02,0.1,0.2,0.15,-0.026,0.004,-0.1499,0.034,-0.0414,853,20,0.2692],
['2016-03-09 09:31','SPXW20160309C00001990','SPXW',1990,'2016-03-09','C',1987.02,4.5,5.1,4.8,0.4885,0.0318,-4.8,0.224,0.771,1164,14,0.223],
['2016-03-09 09:31','SPXW20160309P00001990','SPXW',1990,'2016-03-09','P',1987.02,5.2,6.2,5.7,-0.526,0.0303,-4.8,0.2236,-0.8386,1085,0,0.2337],
['2016-03-09 09:31','SPXW20160309C00002000','SPXW',2000,'2016-03-09','C',1987.02,1,1.4,1.2,0.1836,0.0221,-1.2,0.1492,0.2902,4419,108,0.214],
['2016-03-09 09:31','SPXW20160309P00002000','SPXW',2000,'2016-03-09','P',1987.02,11.2,12.8,12,-0.8242,0.0222,-1.0998,0.1452,-1.3164,928,0,0.2072],
['2016-03-09 09:31','SPXW20160309C00002010','SPXW',2010,'2016-03-09','C',1987.02,0.1,0.25,0.18,0.0376,0.007,-0.175,0.046,0.0595,2764,32,0.2077],
['2016-03-09 09:31','SPXW20160309P00002010','SPXW',2010,'2016-03-09','P',1987.02,19.6,22.4,21,-0.975,0.0055,-0.1,0.0329,-1.5627,158,0,0.1887],
['2016-03-09 09:31','SPXW20160311C00001960','SPXW',1960,'2016-03-11','C',1987.02,31.7,33.8,32.75,0.7889,0.008,-2.2854,0.4554,9.6402,509,0,0.2288],
['2016-03-09 09:31','SPXW20160311P00001960','SPXW',1960,'2016-03-11','P',1987.02,4,4.4,4.2,-0.2078,0.0081,-2.2171,0.4511,-2.6193,2845,0,0.2255],
['2016-03-09 09:31','SPXW20160311C00001990','SPXW',1990,'2016-03-11','C',1987.02,11.9,12.5,12.2,0.4883,0.0124,-2.7967,0.6283,6.0186,10498,8,0.2034],
['2016-03-09 09:31','SPXW20160311P00001990','SPXW',1990,'2016-03-11','P',1987.02,13.4,14.2,13.8,-0.5163,0.0123,-2.8226,0.6279,-6.5307,5053,26,0.2065],
['2016-03-09 09:31','SPXW20160311C00002000','SPXW',2000,'2016-03-11','C',1987.02,7.3,7.9,7.6,0.3592,0.0119,-2.5653,0.5889,4.4347,17045,5,0.1992],
['2016-03-09 09:31','SPXW20160311P00002000','SPXW',2000,'2016-03-11','P',1987.02,18.7,19.8,19.25,-0.6402,0.0119,-2.5632,0.5892,-8.111,3701,10,0.2001],
['2016-03-09 09:31','SPXW20160311C00002010','SPXW',2010,'2016-03-11','C',1987.02,4,4.5,4.25,0.2407,0.0103,-2.0544,0.4904,2.9768,3761,4,0.1916],
['2016-03-09 09:31','SPXW20160311P00002010','SPXW',2010,'2016-03-11','P',1987.02,24.7,26.9,25.8,-0.7605,0.0103,-2.0232,0.4891,-9.6535,529,0,0.1906],
['2016-03-09 09:31','SPXW20160316C00001960','SPXW',1960,'2016-03-16','C',1987.02,37.5,39.5,38.5,0.7015,0.0063,-1.3124,0.9746,27.0879,54,0,0.1949],
['2016-03-09 09:31','SPXW20160316P00001960','SPXW',1960,'2016-03-16','P',1987.02,10.2,10.6,10.4,-0.2975,0.0064,-1.2891,0.9732,-12.0223,285,20,0.1938],
['2016-03-09 09:31','SPXW20160316C00001990','SPXW',1990,'2016-03-16','C',1987.02,18.5,19.5,19,0.4929,0.0081,-1.3602,1.121,19.1966,415,0,0.176],
['2016-03-09 09:31','SPXW20160316P00001990','SPXW',1990,'2016-03-16','P',1987.02,20.5,21.5,21,-0.5109,0.008,-1.3616,1.1204,-20.7067,43,25,0.1782],
['2016-03-09 09:31','SPXW20160316C00002000','SPXW',2000,'2016-03-16','C',1987.02,13.7,14.4,14.05,0.4076,0.008,-1.3009,1.0907,15.9049,557,5,0.1731],
['2016-03-09 09:31','SPXW20160316P00002000','SPXW',2000,'2016-03-16','P',1987.02,25.4,26.5,25.95,-0.5929,0.008,-1.2788,1.0903,-24.0626,158,0,0.1722],
['2016-03-09 09:31','SPXW20160316C00002010','SPXW',2010,'2016-03-16','C',1987.02,9.5,10.1,9.8,0.3244,0.0077,-1.1598,1.0105,12.6864,560,5,0.1667],
['2016-03-09 09:31','SPXW20160316P00002010','SPXW',2010,'2016-03-16','P',1987.02,31,33,32,-0.6736,0.0076,-1.1617,1.013,-27.385,78,0,0.1687],
['2016-03-09 09:45','SPXW20160309C00001960','SPXW',1960,'2016-03-09','C',1986.9,26.2,28.7,27.45,0.9727,0.0044,-0.1501,0.0347,1.4683,67,0,0.2598],
['2016-03-09 09:45','SPXW20160309P00001960','SPXW',1960,'2016-03-09','P',1986.9,0.05,0.2,0.12,-0.0239,0.004,-0.125,0.031,-0.0366,853,0,0.2521],
['2016-03-09 09:45','SPXW20160309C00001990','SPXW',1990,'2016-03-09','C',1986.9,3.3,4,3.65,0.4139,0.0319,-3.6498,0.2149,0.631,1164,0,0.2217],
['2016-03-09 09:45','SPXW20160309P00001990','SPXW',1990,'2016-03-09','P',1986.9,5.5,7.2,6.35,-0.5861,0.0319,-3.6498,0.2149,-0.9024,1085,0,0.2217],
['2016-03-09 09:45','SPXW20160309C00002000','SPXW',2000,'2016-03-09','C',1986.9,0.65,0.85,0.75,0.1322,0.0189,-0.75,0.118,0.2018,4419,3,0.2051],
['2016-03-09 09:45','SPXW20160309P00002000','SPXW',2000,'2016-03-09','P',1986.9,12.3,14.9,13.6,-0.8538,0.0191,-0.9002,0.1264,-1.3179,928,0,0.2174],
['2016-03-09 09:45','SPXW20160309C00002010','SPXW',2010,'2016-03-09','C',1986.9,0.05,0.15,0.1,0.0236,0.0049,-0.1,0.0307,0.036,2764,0,0.2058],
['2016-03-09 09:45','SPXW20160309P00002010','SPXW',2010,'2016-03-09','P',1986.9,21.5,24.3,22.9,-0.961,0.0066,-0.2001,0.0466,-1.4892,158,0,0.2317],
['2016-03-09 09:45','SPXW20160311C00001960','SPXW',1960,'2016-03-11','C',1986.9,30.5,32.1,31.3,0.7727,0.0084,-2.3996,0.4738,9.3972,509,0,0.23],
['2016-03-09 09:45','SPXW20160311P00001960','SPXW',1960,'2016-03-11','P',1986.9,4.6,4.9,4.75,-0.2263,0.0084,-2.368,0.4726,-2.8396,2845,5,0.229],
['2016-03-09 09:45','SPXW20160311C00001990','SPXW',1990,'2016-03-11','C',1986.9,11.3,11.7,11.5,0.4611,0.012,-2.8784,0.6235,5.6529,10498,0,0.2101],
['2016-03-09 09:45','SPXW20160311P00001990','SPXW',1990,'2016-03-11','P',1986.9,14.6,15.4,15,-0.5389,0.012,-2.8637,0.6235,-6.7844,5053,0,0.2101],
['2016-03-09 09:45','SPXW20160311C00002000','SPXW',2000,'2016-03-11','C',1986.9,7,7.3,7.15,0.3397,0.0115,-2.568,0.5752,4.1724,17045,0,0.2033],
['2016-03-09 09:45','SPXW20160311P00002000','SPXW',2000,'2016-03-11','P',1986.9,19.9,21.5,20.7,-0.6597,0.0114,-2.5661,0.5756,-8.3193,3701,0,0.2042],
['2016-03-09 09:45','SPXW20160311C00002010','SPXW',2010,'2016-03-11','C',1986.9,3.9,4.1,4,0.2263,0.0098,-2.0335,0.4725,2.7845,3761,0,0.196],
['2016-03-09 09:45','SPXW20160311P00002010','SPXW',2010,'2016-03-11','P',1986.9,26.7,28.4,27.55,-0.7725,0.0098,-2.0361,0.474,-9.7626,529,0,0.1971],
['2016-03-09 09:45','SPXW20160316C00001960','SPXW',1960,'2016-03-16','C',1986.9,36.3,38,37.15,0.6896,0.0065,-1.3336,0.9901,26.5805,54,0,0.1947],
['2016-03-09 09:45','SPXW20160316P00001960','SPXW',1960,'2016-03-16','P',1986.9,10.8,11.2,11,-0.3099,0.0065,-1.3148,0.9895,-12.4983,285,0,0.1942],
['2016-03-09 09:45','SPXW20160316C00001990','SPXW',1990,'2016-03-16','C',1986.9,17.9,18.4,18.15,0.4741,0.0079,-1.3787,1.1167,18.4203,415,0,0.1789],
['2016-03-09 09:45','SPXW20160316P00001990','SPXW',1990,'2016-03-16','P',1986.9,21.7,22.5,22.1,-0.5258,0.0079,-1.3675,1.1167,-21.2728,43,0,0.1794],
['2016-03-09 09:45','SPXW20160316C00002000','SPXW',2000,'2016-03-16','C',1986.9,13.1,13.5,13.3,0.3926,0.0079,-1.2891,1.0782,15.2876,557,0,0.1733],
['2016-03-09 09:45','SPXW20160316P00002000','SPXW',2000,'2016-03-16','P',1986.9,26.5,28,27.25,-0.6071,0.0079,-1.2781,1.0785,-24.5963,158,9,0.1738],
['2016-03-09 09:45','SPXW20160316C00002010','SPXW',2010,'2016-03-16','C',1986.9,9.1,9.5,9.3,0.3111,0.0075,-1.1467,0.9911,12.1392,560,0,0.1678],
['2016-03-09 09:45','SPXW20160316P00002010','SPXW',2010,'2016-03-16','P',1986.9,32.4,34.1,33.25,-0.6883,0.0075,-1.1363,0.9919,-27.9342,78,0,0.1684],
['2016-03-09 09:55','SPXW20160309C00001960','SPXW',1960,'2016-03-09','C',1985.03,24.5,27,25.75,0.9875,0.0028,-0.05,0.0176,1.4544,67,0,0.2122],
['2016-03-09 09:55','SPXW20160309P00001960','SPXW',1960,'2016-03-09','P',1985.03,0.15,0.2,0.18,-0.0319,0.0051,-0.1749,0.039,-0.0478,853,60,0.2569],
['2016-03-09 09:55','SPXW20160309C00001990','SPXW',1990,'2016-03-09','C',1985.03,2.75,3.2,2.98,0.3622,0.031,-2.975,0.2041,0.5382,1164,10,0.2219],
['2016-03-09 09:55','SPXW20160309P00001990','SPXW',1990,'2016-03-09','P',1985.03,6.7,8.3,7.5,-0.6314,0.0298,-3.2,0.2053,-0.9479,1085,0,0.2328],
['2016-03-09 09:55','SPXW20160309C00002000','SPXW',2000,'2016-03-09','C',1985.03,0.5,0.7,0.6,0.1085,0.0162,-0.6,0.1013,0.1615,4419,0,0.2115],
['2016-03-09 09:55','SPXW20160309P00002000','SPXW',2000,'2016-03-09','P',1985.03,13.8,16.2,15,-0.8812,0.0165,-0.7,0.1081,-1.3263,928,0,0.2211],
['2016-03-09 09:55','SPXW20160309C00002010','SPXW',2010,'2016-03-09','C',1985.03,0.05,0.1,0.08,0.018,0.0039,-0.075,0.0241,0.0268,2764,0,0.2113],
['2016-03-09 09:55','SPXW20160309P00002010','SPXW',2010,'2016-03-09','P',1985.03,23.2,25.7,24.45,-0.9698,0.0053,-0.1501,0.0373,-1.4656,158,0,0.2359],
['2016-03-09 09:55','SPXW20160311C00001960','SPXW',1960,'2016-03-11','C',1985.03,29.5,31.3,30.4,0.752,0.0085,-2.6023,0.4958,9.1104,509,0,0.2378],
['2016-03-09 09:55','SPXW20160311P00001960','SPXW',1960,'2016-03-11','P',1985.03,5.4,5.7,5.55,-0.248,0.0085,-2.5876,0.4958,-3.102,2845,1,0.2377],
['2016-03-09 09:55','SPXW20160311C00001990','SPXW',1990,'2016-03-11','C',1985.03,11,11.3,11.15,0.4432,0.0116,-2.9556,0.6187,5.4118,10498,2,0.2168],
['2016-03-09 09:55','SPXW20160311P00001990','SPXW',1990,'2016-03-11','P',1985.03,15.8,16.7,16.25,-0.557,0.0117,-2.9297,0.6186,-6.9902,5053,0,0.216],
['2016-03-09 09:55','SPXW20160311C00002000','SPXW',2000,'2016-03-11','C',1985.03,6.9,7.1,7,0.3267,0.0109,-2.6219,0.5651,3.9971,17045,2,0.2107],
['2016-03-09 09:55','SPXW20160311P00002000','SPXW',2000,'2016-03-11','P',1985.03,21.6,22.8,22.2,-0.6726,0.0109,-2.6199,0.5656,-8.4565,3701,0,0.2115],
['2016-03-09 09:55','SPXW20160311C00002010','SPXW',2010,'2016-03-11','C',1985.03,3.9,4,3.95,0.2185,0.0093,-2.0665,0.4621,2.6775,3761,1,0.2031],
['2016-03-09 09:55','SPXW20160311P00002010','SPXW',2010,'2016-03-11','P',1985.03,28.4,29.5,28.95,-0.7853,0.0093,-1.9981,0.4574,-9.8925,529,0,0.1999],
['2016-03-09 09:55','SPXW20160316C00001960','SPXW',1960,'2016-03-16','C',1985.03,35.5,37.2,36.35,0.6751,0.0065,-1.3864,1.008,25.9745,54,0,0.1987],
['2016-03-09 09:55','SPXW20160316P00001960','SPXW',1960,'2016-03-16','P',1985.03,11.7,12.1,11.9,-0.3241,0.0065,-1.3636,1.007,-13.0527,285,0,0.1977],
['2016-03-09 09:55','SPXW20160316C00001990','SPXW',1990,'2016-03-16','C',1985.03,17.5,18,17.75,0.4612,0.0078,-1.4037,1.1122,17.8861,415,25,0.1827],
['2016-03-09 09:55','SPXW20160316P00001990','SPXW',1990,'2016-03-16','P',1985.03,23,23.8,23.4,-0.5388,0.0078,-1.389,1.1122,-21.7717,43,0,0.1827],
['2016-03-09 09:55','SPXW20160316C00002000','SPXW',2000,'2016-03-16','C',1985.03,12.8,13.2,13,0.3813,0.0077,-1.304,1.0677,14.8205,557,0,0.1769],
['2016-03-09 09:55','SPXW20160316P00002000','SPXW',2000,'2016-03-16','P',1985.03,28,29.5,28.75,-0.618,0.0077,-1.2969,1.0683,-25.0124,158,0,0.1779],
['2016-03-09 09:55','SPXW20160316C00002010','SPXW',2010,'2016-03-16','C',1985.03,8.9,9.3,9.1,0.3019,0.0073,-1.1546,0.9768,11.7579,560,0,0.1713],
['2016-03-09 09:55','SPXW20160316P00002010','SPXW',2010,'2016-03-16','P',1985.03,34,35.7,34.85,-0.6969,0.0072,-1.1487,0.9784,-28.2554,78,0,0.1724],
['2016-03-09 09:59','SPXW20160309C00001960','SPXW',1960,'2016-03-09','C',1986.1,25,27.8,26.4,1,0,0,0,1.4581,67,0,0.02],
['2016-03-09 09:59','SPXW20160309P00001960','SPXW',1960,'2016-03-09','P',1986.1,0.1,0.15,0.12,-0.0245,0.0042,-0.125,0.0311,-0.0363,853,3,0.2496],
['2016-03-09 09:59','SPXW20160309C00001990','SPXW',1990,'2016-03-09','C',1986.1,2.95,3.4,3.18,0.3826,0.032,-3.175,0.2067,0.563,1164,7,0.22],
['2016-03-09 09:59','SPXW20160309P00001990','SPXW',1990,'2016-03-09','P',1986.1,6.2,7.9,7.05,-0.6108,0.0303,-3.45,0.2078,-0.9078,1085,0,0.2333],
['2016-03-09 09:59','SPXW20160309C00002000','SPXW',2000,'2016-03-09','C',1986.1,0.65,0.8,0.73,0.1248,0.0175,-0.725,0.1114,0.1838,4419,14,0.2167],
['2016-03-09 09:59','SPXW20160309P00002000','SPXW',2000,'2016-03-09','P',1986.1,13.1,15.8,14.45,-0.8635,0.0177,-0.85,0.1185,-1.2868,928,0,0.2276],
['2016-03-09 09:59','SPXW20160309C00002010','SPXW',2010,'2016-03-09','C',1986.1,0.05,0.1,0.08,0.0184,0.004,-0.075,0.0245,0.0272,2764,3,0.2072],
['2016-03-09 09:59','SPXW20160309P00002010','SPXW',2010,'2016-03-09','P',1986.1,22.5,25.2,23.85,-0.9556,0.0068,-0.2501,0.0508,-1.4298,158,0,0.254],
['2016-03-09 09:59','SPXW20160311C00001960','SPXW',1960,'2016-03-11','C',1986.1,30.3,31.6,30.95,0.7542,0.0084,-2.6235,0.4932,9.1259,509,0,0.2406],
['2016-03-09 09:59','SPXW20160311P00001960','SPXW',1960,'2016-03-11','P',1986.1,5.3,5.6,5.45,-0.244,0.0084,-2.5767,0.4913,-3.0489,2845,0,0.2386],
['2016-03-09 09:59','SPXW20160311C00001990','SPXW',1990,'2016-03-11','C',1986.1,11.2,11.5,11.35,0.4494,0.0117,-2.9564,0.6198,5.4822,10498,0,0.2162],
['2016-03-09 09:59','SPXW20160311P00001990','SPXW',1990,'2016-03-11','P',1986.1,15.5,16.3,15.9,-0.5508,0.0117,-2.9305,0.6198,-6.9045,5053,0,0.2154],
['2016-03-09 09:59','SPXW20160311C00002000','SPXW',2000,'2016-03-11','C',1986.1,7,7.2,7.1,0.3316,0.0111,-2.6233,0.5683,4.0532,17045,0,0.2093],
['2016-03-09 09:59','SPXW20160311P00002000','SPXW',2000,'2016-03-11','P',1986.1,20.7,22.3,21.5,-0.6712,0.0112,-2.5557,0.5664,-8.4267,3701,0,0.2058],
['2016-03-09 09:59','SPXW20160311C00002010','SPXW',2010,'2016-03-11','C',1986.1,3.9,4.2,4.05,0.2231,0.0094,-2.0898,0.4675,2.7312,3761,0,0.2028],
['2016-03-09 09:59','SPXW20160311P00002010','SPXW',2010,'2016-03-11','P',1986.1,27.4,29.4,28.4,-0.7832,0.0095,-1.9865,0.4599,-9.8535,529,0,0.1974],
['2016-03-09 09:59','SPXW20160316C00001960','SPXW',1960,'2016-03-16','C',1986.1,35.8,37.6,36.7,0.6801,0.0065,-1.3725,1.0018,26.1604,54,0,0.1978],
['2016-03-09 09:59','SPXW20160316P00001960','SPXW',1960,'2016-03-16','P',1986.1,11.5,11.9,11.7,-0.3199,0.0065,-1.3579,1.0018,-12.8842,285,0,0.1978],
['2016-03-09 09:59','SPXW20160316C00001990','SPXW',1990,'2016-03-16','C',1986.1,17.8,18.3,18.05,0.4663,0.0078,-1.4063,1.1137,18.0786,415,0,0.1828],
['2016-03-09 09:59','SPXW20160316P00001990','SPXW',1990,'2016-03-16','P',1986.1,22.7,23.4,23.05,-0.5337,0.0078,-1.3916,1.1137,-21.564,43,0,0.1828],
['2016-03-09 09:59','SPXW20160316C00002000','SPXW',2000,'2016-03-16','C',1986.1,13,13.5,13.25,0.3863,0.0077,-1.3101,1.072,15.0129,557,0,0.177],
['2016-03-09 09:59','SPXW20160316P00002000','SPXW',2000,'2016-03-16','P',1986.1,27.5,29,28.25,-0.6137,0.0077,-1.2954,1.072,-24.8288,158,0,0.177],
['2016-03-09 09:59','SPXW20160316C00002010','SPXW',2010,'2016-03-16','C',1986.1,9.1,9.4,9.25,0.3061,0.0073,-1.1594,0.9829,11.9208,560,0,0.1709],
['2016-03-09 09:59','SPXW20160316P00002010','SPXW',2010,'2016-03-16','P',1986.1,33.4,35.2,34.3,-0.6933,0.0073,-1.149,0.9837,-28.0988,78,0,0.1714],
['2016-03-09 16:00','SPXW20160309C00001960','SPXW',1960,'2016-03-09','C',1988.86,24.8,33.4,29.1,0.9677,0.0046,-27.4039,0.0109,0.1082,67,0,1.0505],
['2016-03-09 16:00','SPXW20160309P00001960','SPXW',1960,'2016-03-09','P',1988.86,0,0.05,0.02,-0.0065,0.0016,-0.0249,0.0028,-0.0007,853,0,0.7815],
['2016-03-09 16:00','SPXW20160309C00001990','SPXW',1990,'2016-03-09','C',1988.86,0,0.1,0.05,0.1132,0.2112,-0.0499,0.0288,0.0128,1164,41,0.0605],
['2016-03-09 16:00','SPXW20160309P00001990','SPXW',1990,'2016-03-09','P',1988.86,0.6,1.7,1.15,-0.8868,0.1132,-1.1499,0.0288,-0.1007,1085,0,0.0605],
['2016-03-09 16:00','SPXW20160309C00002000','SPXW',2000,'2016-03-09','C',1988.86,0,0.05,0.02,0.0141,0.0071,-0.025,0.0054,0.0016,4419,0,0.3354],
['2016-03-09 16:00','SPXW20160309P00002000','SPXW',2000,'2016-03-09','P',1988.86,6.3,15.2,10.75,-1,0,0,0,-0.1142,928,0,0.02],
['2016-03-09 16:00','SPXW20160309C00002010','SPXW',2010,'2016-03-09','C',1988.86,0,0.05,0.02,0.0085,0.0026,-0.025,0.0035,0.001,2764,0,0.5852],
['2016-03-09 16:00','SPXW20160309P00002010','SPXW',2010,'2016-03-09','P',1988.86,16.1,25.2,20.65,-1,0,0,0,-0.1147,158,0,0.02],
['2016-03-09 16:00','SPXW20160311C00001960','SPXW',1960,'2016-03-11','C',1988.86,30.3,33.2,31.75,0.8224,0.0082,-2.0425,0.385,8.8789,509,1,0.2132],
['2016-03-09 16:00','SPXW20160311P00001960','SPXW',1960,'2016-03-11','P',1988.86,3,3.3,3.15,-0.1805,0.0082,-2.0731,0.3889,-2.0043,2845,0,0.2157],
['2016-03-09 16:00','SPXW20160311C00001990','SPXW',1990,'2016-03-11','C',1988.86,11,11.5,11.25,0.4926,0.0137,-2.8815,0.5904,5.3634,10498,1,0.1968],
['2016-03-09 16:00','SPXW20160311P00001990','SPXW',1990,'2016-03-11','P',1988.86,12,13.1,12.55,-0.5144,0.0134,-2.931,0.5899,-5.7333,5053,0,0.2013],
['2016-03-09 16:00','SPXW20160311C00002000','SPXW',2000,'2016-03-11','C',1988.86,6.6,6.9,6.75,0.3506,0.0129,-2.6478,0.5484,3.8227,17045,5,0.1948],
['2016-03-09 16:00','SPXW20160311P00002000','SPXW',2000,'2016-03-11','P',1988.86,17.8,19.6,18.7,-0.6409,0.0122,-2.8171,0.5531,-7.1605,3701,4,0.2066],
['2016-03-09 16:00','SPXW20160311C00002010','SPXW',2010,'2016-03-11','C',1988.86,3.6,3.9,3.75,0.2294,0.0107,-2.1289,0.4487,2.5054,3761,300,0.1915],
['2016-03-09 16:00','SPXW20160311P00002010','SPXW',2010,'2016-03-11','P',1988.86,23.8,26.6,25.2,-0.7666,0.0106,-2.1718,0.453,-8.5803,529,0,0.1948],
['2016-03-09 16:00','SPXW20160316C00001960','SPXW',1960,'2016-03-16','C',1988.86,36.7,38.7,37.7,0.7162,0.0066,-1.2503,0.9344,26.6664,54,0,0.1863],
['2016-03-09 16:00','SPXW20160316P00001960','SPXW',1960,'2016-03-16','P',1988.86,9.1,9.9,9.5,-0.287,0.0065,-1.2637,0.9393,-11.1584,285,2,0.1896],
['2016-03-09 16:00','SPXW20160316C00001990','SPXW',1990,'2016-03-16','C',1988.86,18,19.1,18.55,0.4976,0.0084,-1.358,1.1005,18.6826,415,0,0.1724],
['2016-03-09 16:00','SPXW20160316P00001990','SPXW',1990,'2016-03-16','P',1988.86,19.4,20.7,20.05,-0.5075,0.0083,-1.3655,1.1,-19.7971,43,0,0.1753],
['2016-03-09 16:00','SPXW20160316C00002000','SPXW',2000,'2016-03-16','C',1988.86,13.1,14.1,13.6,0.4082,0.0083,-1.3049,1.0709,15.349,557,0,0.1703],
['2016-03-09 16:00','SPXW20160316P00002000','SPXW',2000,'2016-03-16','P',1988.86,24.4,26.3,25.35,-0.5905,0.0082,-1.309,1.0717,-23.0726,158,0,0.1727],
['2016-03-09 16:00','SPXW20160316C00002010','SPXW',2010,'2016-03-16','C',1988.86,9.2,10,9.6,0.3246,0.0078,-1.1789,0.992,12.2287,560,0,0.1662],
['2016-03-09 16:00','SPXW20160316P00002010','SPXW',2010,'2016-03-16','P',1988.86,30.3,32.4,31.35,-0.6729,0.0078,-1.1858,0.9952,-26.3381,78,0,0.1687],
['2016-03-09 16:01','SPXW20160309C00001960','SPXW',1960,'2016-03-09','C',1989.12,24.8,33.4,29.1,0.9677,0.0046,-28.3546,0.0107,0.1046,67,0,1.0685],
['2016-03-09 16:01','SPXW20160309P00001960','SPXW',1960,'2016-03-09','P',1989.12,0,0.05,0.02,-0.0065,0.0016,-0.025,0.0027,-0.0007,853,0,0.795],
['2016-03-09 16:01','SPXW20160309C00001990','SPXW',1990,'2016-03-09','C',1989.12,0,0.1,0.05,0.1132,0.2112,-0.05,0.0284,0.0124,1164,0,0.0615],
['2016-03-09 16:01','SPXW20160309P00001990','SPXW',1990,'2016-03-09','P',1989.12,0.6,1.7,1.15,-0.8868,0.1132,-1.15,0.0284,-0.0974,1085,0,0.0615],
['2016-03-09 16:01','SPXW20160309C00002000','SPXW',2000,'2016-03-09','C',1989.12,0,0.05,0.02,0.0141,0.0071,-0.0251,0.0053,0.0015,4419,0,0.3414],
['2016-03-09 16:01','SPXW20160309P00002000','SPXW',2000,'2016-03-09','P',1989.12,6.3,15.2,10.75,-1,0,0,0,-0.1104,928,0,0.02],
['2016-03-09 16:01','SPXW20160309C00002010','SPXW',2010,'2016-03-09','C',1989.12,0,0.05,0.02,0.0085,0.0026,-0.025,0.0034,0.0009,2764,0,0.5952],
['2016-03-09 16:01','SPXW20160309P00002010','SPXW',2010,'2016-03-09','P',1989.12,16.1,25.2,20.65,-1,0,0,0,-0.1109,158,0,0.02],
['2016-03-09 16:01','SPXW20160311C00001960','SPXW',1960,'2016-03-11','C',1989.12,31.1,33.1,32.1,0.8283,0.0081,-1.9851,0.3769,8.9415,509,0,0.2115],
['2016-03-09 16:01','SPXW20160311P00001960','SPXW',1960,'2016-03-11','P',1989.12,2.95,3.2,3.08,-0.1768,0.0081,-2.0511,0.3839,-1.9631,2845,0,0.2161],
['2016-03-09 16:01','SPXW20160311C00001990','SPXW',1990,'2016-03-11','C',1989.12,11.2,11.6,11.4,0.4961,0.0137,-2.8898,0.5904,5.3994,10498,3,0.1972],
['2016-03-09 16:01','SPXW20160311P00001990','SPXW',1990,'2016-03-11','P',1989.12,11.9,12.5,12.2,-0.5078,0.0135,-2.9108,0.5903,-5.6584,5053,0,0.1998],
['2016-03-09 16:01','SPXW20160311C00002000','SPXW',2000,'2016-03-11','C',1989.12,6.8,7.1,6.95,0.3573,0.0129,-2.6726,0.5522,3.8953,17045,0,0.1952],
['2016-03-09 16:01','SPXW20160311P00002000','SPXW',2000,'2016-03-11','P',1989.12,17.1,18.6,17.85,-0.6414,0.0128,-2.6863,0.5529,-7.1598,3701,0,0.197],
['2016-03-09 16:01','SPXW20160311C00002010','SPXW',2010,'2016-03-11','C',1989.12,3.7,4,3.85,0.2344,0.0108,-2.1518,0.4541,2.5593,3761,0,0.1911],
['2016-03-09 16:01','SPXW20160311P00002010','SPXW',2010,'2016-03-11','P',1989.12,23.9,25.6,24.75,-0.763,0.0108,-2.1749,0.4569,-8.5371,529,0,0.1933],
['2016-03-09 16:01','SPXW20160316C00001960','SPXW',1960,'2016-03-16','C',1989.12,37.2,39.2,38.2,0.7165,0.0065,-1.2651,0.934,26.6735,54,0,0.1886],
['2016-03-09 16:01','SPXW20160316P00001960','SPXW',1960,'2016-03-16','P',1989.12,9.1,9.5,9.3,-0.2834,0.0065,-1.2505,0.934,-11.021,285,0,0.1886],
['2016-03-09 16:01','SPXW20160316C00001990','SPXW',1990,'2016-03-16','C',1989.12,18.5,19,18.75,0.4994,0.0083,-1.3653,1.1006,18.7451,415,0,0.1733],
['2016-03-09 16:01','SPXW20160316P00001990','SPXW',1990,'2016-03-16','P',1989.12,19.4,20.3,19.85,-0.5042,0.0083,-1.3663,1.1003,-19.6688,43,0,0.1753],
['2016-03-09 16:01','SPXW20160316C00002000','SPXW',2000,'2016-03-16','C',1989.12,13.5,14,13.75,0.4114,0.0083,-1.3068,1.0731,15.4716,557,0,0.1702],
['2016-03-09 16:01','SPXW20160316P00002000','SPXW',2000,'2016-03-16','P',1989.12,24.1,25.7,24.9,-0.5883,0.0083,-1.2958,1.0732,-22.9838,158,0,0.1707],
['2016-03-09 16:01','SPXW20160316C00002010','SPXW',2010,'2016-03-16','C',1989.12,9.5,9.9,9.7,0.3274,0.0079,-1.1813,0.9957,12.3364,560,20,0.1659],
['2016-03-09 16:01','SPXW20160316P00002010','SPXW',2010,'2016-03-16','P',1989.12,29.9,31.8,30.85,-0.6721,0.0079,-1.1709,0.9963,-26.3014,78,0,0.1664],
['2016-03-09 16:15','SPXW20160309C00001960','SPXW',1960,'2016-03-09','C',1989.26,24.8,33.4,29.1,0.9677,0.0046,-29.0999,0.0077,0.0541,67,0,1.4856],
['2016-03-09 16:15','SPXW20160309P00001960','SPXW',1960,'2016-03-09','P',1989.26,0,0.05,0.02,-0.0065,0.0016,-0.025,0.002,-0.0004,853,0,1.1056],
['2016-03-09 16:15','SPXW20160309C00001990','SPXW',1990,'2016-03-09','C',1989.26,0,0.1,0.05,0.1132,0.2112,-0.05,0.0204,0.0064,1164,0,0.0856],
['2016-03-09 16:15','SPXW20160309P00001990','SPXW',1990,'2016-03-09','P',1989.26,0.6,1.7,1.15,-0.8868,0.1132,-1.15,0.0204,-0.0504,1085,0,0.0856],
['2016-03-09 16:15','SPXW20160309C00002000','SPXW',2000,'2016-03-09','C',1989.26,0,0.05,0.02,0.0141,0.0071,-0.025,0.0038,0.0008,4419,0,0.4744],
['2016-03-09 16:15','SPXW20160309P00002000','SPXW',2000,'2016-03-09','P',1989.26,6.3,15.2,10.75,-1,0,0,0,-0.0571,928,0,0.02],
['2016-03-09 16:15','SPXW20160309C00002010','SPXW',2010,'2016-03-09','C',1989.26,0,0.05,0.02,0.0085,0.0026,-0.025,0.0025,0.0005,2764,0,0.8274],
['2016-03-09 16:15','SPXW20160309P00002010','SPXW',2010,'2016-03-09','P',1989.26,16.1,25.2,20.65,-1,0,0,0,-0.0574,158,0,0.02],
['2016-03-09 16:15','SPXW20160311C00001960','SPXW',1960,'2016-03-11','C',1989.26,31.2,33.5,32.35,0.8242,0.0081,-2.0664,0.3816,8.8529,509,0,0.2165],
['2016-03-09 16:15','SPXW20160311P00001960','SPXW',1960,'2016-03-11','P',1989.26,2.85,3.1,2.98,-0.1736,0.0081,-2.0171,0.3786,-1.9183,2845,0,0.2145],
['2016-03-09 16:15','SPXW20160311C00001990','SPXW',1990,'2016-03-11','C',1989.26,10.9,11.7,11.3,0.4987,0.0139,-2.8541,0.5891,5.4031,10498,0,0.1943],
['2016-03-09 16:15','SPXW20160311P00001990','SPXW',1990,'2016-03-11','P',1989.26,11.6,12.4,12,-0.5066,0.0137,-2.8881,0.5889,-5.6173,5053,10,0.1977],
['2016-03-09 16:15','SPXW20160311C00002000','SPXW',2000,'2016-03-11','C',1989.26,6.6,7.1,6.85,0.3568,0.0131,-2.6513,0.5506,3.8721,17045,0,0.1932],
['2016-03-09 16:15','SPXW20160311P00002000','SPXW',2000,'2016-03-11','P',1989.26,16.8,18.5,17.65,-0.6418,0.013,-2.6646,0.5513,-7.1298,3701,0,0.195],
['2016-03-09 16:15','SPXW20160311C00002010','SPXW',2010,'2016-03-11','C',1989.26,3.5,3.9,3.7,0.2309,0.011,-2.1013,0.4493,2.5095,3761,0,0.1878],
['2016-03-09 16:15','SPXW20160311P00002010','SPXW',2010,'2016-03-11','P',1989.26,23.4,25.5,24.45,-0.7678,0.0109,-2.1058,0.4507,-8.5469,529,0,0.1889],
['2016-03-09 16:15','SPXW20160316C00001960','SPXW',1960,'2016-03-16','C',1989.26,37.3,39.3,38.3,0.7169,0.0065,-1.268,0.9328,26.6502,54,0,0.1891],
['2016-03-09 16:15','SPXW20160316P00001960','SPXW',1960,'2016-03-16','P',1989.26,8.8,9.4,9.1,-0.281,0.0065,-1.235,0.9294,-10.9087,285,0,0.1869],
['2016-03-09 16:15','SPXW20160316C00001990','SPXW',1990,'2016-03-16','C',1989.26,18.3,19,18.65,0.5001,0.0084,-1.3566,1.0999,18.7511,415,0,0.172],
['2016-03-09 16:15','SPXW20160316P00001990','SPXW',1990,'2016-03-16','P',1989.26,19.2,20.1,19.65,-0.5035,0.0083,-1.3576,1.0996,-19.6111,43,0,0.1741],
['2016-03-09 16:15','SPXW20160316C00002000','SPXW',2000,'2016-03-16','C',1989.26,13.3,14.1,13.7,0.4117,0.0083,-1.3024,1.0726,15.4652,557,0,0.1695],
['2016-03-09 16:15','SPXW20160316P00002000','SPXW',2000,'2016-03-16','P',1989.26,24.3,25.2,24.75,-0.588,0.0083,-1.2915,1.0728,-22.9368,158,0,0.1699],
['2016-03-09 16:15','SPXW20160316C00002010','SPXW',2010,'2016-03-16','C',1989.26,9.3,9.9,9.6,0.3268,0.0079,-1.1727,0.9943,12.2998,560,0,0.1647],
['2016-03-09 16:15','SPXW20160316P00002010','SPXW',2010,'2016-03-16','P',1989.26,29.7,31.7,30.7,-0.6721,0.0079,-1.1666,0.9956,-26.2656,78,0,0.1657],
]

def quote_datetime_to_datetime(x):
    return {**x, 'quote_datetime': datetime.datetime.strptime(x['quote_datetime'], "%Y-%m-%d %H:%M")}

def intraday_option_type_from_str(x):
    return {**x, 'option_type': OptionType.CALL if x['option_type'] == 'C' else OptionType.PUT}

intraday_test_data = list(map(lambda x: dict(zip(fields_, x)), data))
intraday_test_data = list(map(quote_datetime_to_datetime, intraday_test_data))
intraday_test_data = list(map(expiration_to_date, intraday_test_data))
intraday_test_data = list(map(intraday_option_type_from_str, intraday_test_data))
intraday_test_options = create_option_objects(intraday_test_data)

intraday_test_df = pd.DataFrame(data, columns=column_names)
intraday_test_df = intraday_test_df.rename(columns=col_mapping)
intraday_test_df = intraday_test_df.sort_values(by=['quote_datetime', 'expiration', 'strike'])
intraday_test_df['quote_datetime'] = pd.to_datetime(intraday_test_df['quote_datetime'])
intraday_test_df['expiration'] = pd.to_datetime(intraday_test_df['expiration']).dt.date

# def get_option_chain_items(quote_date):
#     df = intraday_test_df[intraday_test_df.index == quote_date]
#     expirations = [x for x in list(df['expiration'].unique())]
#     exp_str = df[['expiration', 'strike']].drop_duplicates().to_numpy().tolist()
#     expiration_strikes = {exp: [s for (e, s) in exp_str if e == exp] for exp in expirations}
#     return test_options, expirations, expiration_strikes
